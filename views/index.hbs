<!--main-container-part-->
<div id="content">
  <!--breadcrumbs-->
  <div id="content-header">
    <div id="breadcrumb"> <a href="/" title="Go to Home" class="tip-bottom"><i class="icon-home"></i> Home</a></div>
  </div>
  <!--End-breadcrumbs-->

  <!--Content-->
  <div class="container-fluid">
    <!--Action boxes-->
    <div class="quick-actions_homepage">
      <ul class="quick-actions">
        <li class="bg_lb"> <a href="/"> <i class="icon-dashboard"></i> Trang chủ </a> </li>
        <li class="bg_lo"> <a href="/product"> <i class="icon-th"></i> Sản phẩm </a> </li>
        <li class="bg_ly"> <a href="/user"> <i class="icon-user"></i> Người dùng </a> </li>
        <li class="bg_ls"> <a href="/order"> <i class="icon-user"></i> Đơn đặt hàng </a> </li>
      </ul>
    </div>
    <!--End-Action boxes-->    

    <!--Chart-box-->    
    <div class="row-fluid">
      <div class="widget-box">
        <div class="widget-title bg_lg"><span class="icon"><i class="icon-signal"></i></span>
        </div>
        <div class="widget-content" >
          <div class="row-fluid">
            <div class="span9">
              <canvas id="user-access-chart"></canvas>
            </div>
            <div class="span3">
              <ul class="site-stats">
                <li class="bg_lh"><i class="icon-user"></i> <strong>{{totalUser}}</strong> <small>Người dùng</small></li>
                <li class="bg_lh"><i class="icon-globe"></i> <strong id="online-user">{{onlineUser}}</strong> <small>Người dùng online</small></li>
                <li class="bg_lh"><i class="icon-shopping-cart"></i> <strong>{{totalProduct}}</strong> <small>Sản phẩm</small></li>
                <li class="bg_lh"><i class="icon-tag"></i> <strong>{{totalOrder}}</strong> <small>Đơn hàng</small></li>
              </ul>
            </div>
          </div>

          <div class="row-fluid" style="margin-top: 50px;">
            <div class="span6">
              <div class="widget-box">
                <div class="widget-content">
                  <canvas id="top-search-query-chart"></canvas>
                </div>
              </div>
            </div>
            <div class="span6">
              <div class="widget-box">
                <div class="widget-content">
                  <canvas id="user-location-chart"></canvas>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <hr/>
    <!--End-Chart-box--> 
  </div>
</div>
<!--end-main-container-part-->

<script src="https://cdn.jsdelivr.net/gh/emn178/chartjs-plugin-labels/src/chartjs-plugin-labels.js"></script>
<script src="/javascripts/chart.js"></script>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script>
  const userAccess = JSON.parse(decodeURIComponent("{{{userAccess}}}"));
  const topSearchQuery = JSON.parse(decodeURIComponent("{{{topSearchQuery}}}"));
  const userLocation = JSON.parse(decodeURIComponent("{{{userLocation}}}"));
  drawUserAccessChart(userAccess.dates, userAccess.counts); 
  drawTopSearchQueryChart(topSearchQuery.keywords, topSearchQuery.counts); 
  drawUserLocationChart(userLocation.locations, userLocation.counts); 
</script>
<script>
  const tag = document.getElementById('online-user');
  setInterval(() => {
    axios.get('/api/getOnlineUser')
    .then(function(response) {
      tag.innerHTML = response.data.onlineUser;
    });
  }, 2000);
</script>